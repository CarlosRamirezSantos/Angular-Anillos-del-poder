<div class="contenedor-oscuro">
    
    <p-toast></p-toast>
    <p-confirmDialog [style]="{width: '450px'}"></p-confirmDialog>
    
    <div class="header-acciones">
        <p-button 
            label="Crear Personaje" 
            icon="pi pi-plus" 
            (onClick)="crearPersonaje()">
        </p-button>
    </div>

    <p-table [value]="personajes" [paginator]="true" [rows]="5">
        
        <ng-template pTemplate="header">
            <tr>
                <th>Nombre</th>
                <th>Raza</th>
                <th>Fecha Nacimiento</th>
                <th>Estado</th> <th style="width: 180px; text-align: center;">Acciones</th>
            </tr>
        </ng-template>

        <ng-template pTemplate="body" let-item>
            <tr [ngClass]="{'fila-baja': item.fechaBaja}">
                <td>{{ item.nombre }}</td>
                <td>{{ item.raza }}</td>
                <td>{{ item.fechaNacimiento | date:'dd/MM/yyyy' }}</td>
                
                <td>
                    @if (item.fechaBaja) {
                        <span style="color: red; font-weight: bold;">BAJA ({{item.fechaBaja | date:'dd/MM/yy'}})</span>
                    } @else {
                        <span style="color: green; font-weight: bold;">ACTIVO</span>
                    }
                </td>

                <td style="text-align: center; display: flex; justify-content: center; gap: 0.5rem;">
                    
                    <p-button 
                        icon="pi pi-cog" 
                        severity="warn" 
                        [rounded]="true" 
                        pTooltip="Editar"
                        tooltipPosition="top"
                        (onClick)="editar(item.id)">
                    </p-button>
                    
                    @if (item.fechaBaja) {
                        <p-button 
                            icon="pi pi-refresh" 
                            severity="success" 
                            [rounded]="true" 
                            pTooltip="Reactivar Personaje"
                            tooltipPosition="top"
                            (onClick)="confirmarAccionLogica($event, item)">
                        </p-button>
                    } @else {
                        <p-button 
                            icon="pi pi-eye-slash" 
                            severity="secondary" 
                            [rounded]="true" 
                            pTooltip="Baja LÃ³gica"
                            tooltipPosition="top"
                            (onClick)="confirmarAccionLogica($event, item)">
                        </p-button>
                    }

                    <p-button 
                        icon="pi pi-trash" 
                        severity="danger" 
                        [rounded]="true" 
                        pTooltip="Eliminar Definitivamente"
                        tooltipPosition="top"
                        (onClick)="confirmarBajaFisica($event, item.id)">
                    </p-button>
                </td>
            </tr>
        </ng-template>
        
        <ng-template pTemplate="emptymessage">
            <tr><td colspan="5">No hay personajes.</td></tr>
        </ng-template>

    </p-table>
</div>